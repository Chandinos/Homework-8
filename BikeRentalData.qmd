---
title: "Homework8"
format: html
editor: visual
---

```{r}
library(tidyverse)
library(janitor)
library(lubridate)
```

## Reading in Data

```{r}
#Fixing nchar error
data <- read_csv("SeoulBikeData.csv", locale = locale(encoding = "latin1"))
```

## EDA

### Checking for Missing Data

To begin the Exploratory Data Analysis, I first checked for any missing columns. Missing values can potentially introduce bias (or errors) in any modeling done down the road.

```{r}
colSums(is.na(data))
```

The results show that there is no missing data in the current data set, meaning the data set is complete.

### Checking Columns Types and Values within Columns

The next step is to check if each variable is stored under the correct data type and that the values of each variable make sense given the variable definitions.Categorical variables need to have their unique values checked as well.

```{r}
glimpse(data)
summary(data)
lapply(data[c("Seasons", "Holiday", "Functioning Day")], unique)
```

The data set appears to be clean. Categorical variables have expected values; for example, **Seasons** has values such as "Winter", **Holiday** has "No Holiday", and **Functioning Day** has "Yes". The numeric variables have expected ranges such as **Hours** not exceeding 24 and **Humidity(%)** not exceeding 100.

### Converting Date Column

The date column is currently read simply as text so it needs to be converted to an actual Date object.

```{r}
data$Date <- dmy(data$Date)
```

This change will allow for time-based grouping and plotting later.

### Convert Character Variables to Factors

Categorical variables are being changed from character to factor variables.

```{r}
data <- data |>
  mutate(
    Seasons = as.factor(Seasons),
    Holiday = as.factor(Holiday),
    `Functioning Day` = as.factor(`Functioning Day`)
  )
```

They have been changed to factor variables for better summaries and modeling later on.

### Rename Columns

The variables names are being converted to PascalCase making them easier to use.

```{r}
data <- data |> clean_names(case = "big_camel")
glimpse(data)
```

Now variables like **'Rented Bike Count'** appear as **RentedBikeCount** and **'Functioning Day'** appear as **FunctioningDay**.

### Create Summary Statistics

I explored RentedBikeCount across key categorical variables.

```{r}
#Five-Number Summary
summary(data$RentedBikeCount)

#RentedBikeCount Mean by Season
data |> 
  group_by(Seasons) |>
  summarise(MeanBikes = mean(RentedBikeCount))

#RentedBikeCount Mean by Holiday
data |> 
  group_by(Holiday) |>
  summarise(MeanBikes = mean(RentedBikeCount))

#RentedBikeCount Mean by Functioning Day
data |> 
  group_by(FunctioningDay) |>
  summarise(MeanBikes = mean(RentedBikeCount))

#Subsetting Data to Only Include Functioning Day = Yes
data <- data |> filter(FunctioningDay == "Yes")

```

The mean rented bike count across FunctioningDay showed that when that variable takes on a value of "no", the operation was in fact closed. Therefore, I subsetted the data to only include days in which the company was operational (FunctioningDay = "Yes").

### Summarize the Data to have only One Observation per Day

The current data set records values on an hourly basis, so the data is going to be summarized in a way that each observation represents the counts and averages for the **day**. This will allows us to work with the data on a day by day basis, not hour by hour basis.

```{r}
DailyData <- data |>
  group_by(Date, Seasons, Holiday) |>
  summarise(
    TotalBikeCount = sum(RentedBikeCount, na.rm = TRUE),
    TotalRainfallMm = sum(RainfallMm, na.rm = TRUE),
    TotalSnowfallCm = sum(SnowfallCm, na.rm = TRUE),
    MeanTempC = mean(TemperatureC, na.rm = TRUE),
    MeanHumidityPercent = mean(HumidityPercent, na.rm = TRUE),
    MeanWindSpeedMs = mean(WindSpeedMS, na.rm = TRUE),
    MeanVisibility10M = mean(Visibility10M, na.rm = TRUE),
    MeanDewPointC = mean(DewPointTemperatureC, na.rm = TRUE),
    MeanSolarMjm2 = mean(SolarRadiationMjM2, na.rm = TRUE),
    .groups = "drop"
  )

#Saving the New Data 
write.csv(DailyData, "SeoulBikeDataDaily.csv")
```

The new data set that we are going to work with contains 353 daily observations (as opposed to 8465 before) representing the 353 days out the year that the rental shop was open. It now contains summarized daily weather information and total daily rentals.

### Exploring Relationships / Coorelations (using New Data Set)

I am going to check the daily summaries using the new data set. I am also going to check the correlations between numeric variables.

```{r}
#Basic Summaries
summary(DailyData)

#Correlation (Numeric Variables)
NumericVars <- select(DailyData, where(is.numeric))
round(cor(NumericVars, use = "pairwise.complete.obs"), 2)
```

Now I am going to exploring relationships using plots. Specifically, *Humidity vs Bike Rental Total*, *Trend over Over Time*, *Holiday Rentals vs Non-Holiday Rentals*, & *Temperature vs Rentals (Colored by Season)*

```{r}
# Humidity vs Bike Rental Total 
ggplot(DailyData, aes(x = MeanHumidityPercent, y = TotalBikeCount)) + geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", se = FALSE, color = "cyan") + 
  labs(title = "Daily Bike Rentals vs Humidity",
       x = "Mean Daily Humidity(%)",
       y = "Total Daily Bike Rentals")
```

This plot shows that there is not a strong relationship between humidity and daily bike rentals. The correlation is 0.04 along with the scatterplot leads up to conclude that humidity alone is not a driving force of consumer bike rental behavior.

```{r}
# Trend of Bike Rentals over Time
ggplot(DailyData, aes(x = Date, y = TotalBikeCount, color = Seasons)) + geom_line(alpha = 0.8) +
  labs(title = "Trend of Bike Rentals over Time",
       x = "Date",
       y = "Total Daily Bike Rentals")
```

In the figure above, the daily trend over time shows rentals are low in the wintertime and then steadily increases through the spring into the summer. There is a small decline in late summer/early fall with a brief rebound in September/October before tapering off as winter approaches. Although there are clear fluctuations present, the overall trend is low bike rentals over the cold periods of the year and peak bike rentals occuring in the warm periods of the year.
